import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# T·∫°o d·ªØ li·ªáu m·∫´u
np.random.seed(42)

# ===== SHEET 1: B√ÅN H√ÄNG =====
sales_data = {
    'Ng√†y': pd.date_range('2024-01-01', periods=100),
    'S·∫£n ph·∫©m': np.random.choice(['Laptop', 'ƒêi·ªán tho·∫°i', 'Tablet', 'Tai nghe', 'Chu·ªôt'], 100),
    'Khu v·ª±c': np.random.choice(['H√† N·ªôi', 'TP.HCM', 'ƒê√† N·∫µng', 'C·∫ßn Th∆°', 'H·∫£i Ph√≤ng'], 100),
    'S·ªë l∆∞·ª£ng': np.random.randint(1, 50, 100),
    'ƒê∆°n gi√° (VNƒê)': np.random.choice([500000, 1000000, 1500000, 2000000, 3000000], 100),
    'Doanh thu (VNƒê)': np.random.randint(500000, 50000000, 100),
    'L·ª£i nhu·∫≠n (%)': np.random.uniform(10, 40, 100).round(1)
}
df_sales = pd.DataFrame(sales_data)
df_sales['T·ªïng ti·ªÅn'] = df_sales['S·ªë l∆∞·ª£ng'] * df_sales['ƒê∆°n gi√° (VNƒê)']

# ===== SHEET 2: NH√ÇN VI√äN =====
employees_data = {
    'M√£ NV': [f'NV{i:03d}' for i in range(1, 51)],
    'H·ªç t√™n': ['Nguy·ªÖn VƒÉn A', 'Tr·∫ßn Th·ªã B', 'Ph·∫°m Minh C', 'Ho√†ng Tu·∫•n D', 'L√™ Thu E',
               'V≈© H·∫£i F', 'ƒê·∫∑ng Hoa G', 'B√πi Long H', 'T√¥ Minh I', 'Cao Th·∫Øng J'] * 5,
    'Ph√≤ng ban': np.random.choice(['B√°n h√†ng', 'K·ªπ thu·∫≠t', 'T√†i ch√≠nh', 'Marketing', 'H√†nh ch√≠nh'], 50),
    'L∆∞∆°ng c∆° b·∫£n': np.random.randint(5000000, 20000000, 50),
    'NƒÉm kinh nghi·ªám': np.random.randint(1, 15, 50),
    'Ng√†y v√†o': pd.date_range('2015-01-01', periods=50, freq='M'),
    'ƒê√°nh gi√°': np.random.choice(['Xu·∫•t s·∫Øc', 'T·ªët', 'Trung b√¨nh', 'C·∫ßn c·∫£i thi·ªán'], 50),
    'Tr·∫°ng th√°i': np.random.choice(['ƒêang l√†m', 'Th√¥i vi·ªác', 'Ngh·ªâ ph√©p'], 50)
}
df_employees = pd.DataFrame(employees_data)

# ===== SHEET 3: KH√ÅCH H√ÄNG =====
customers_data = {
    'M√£ kh√°ch': [f'KH{i:04d}' for i in range(1, 201)],
    'T√™n kh√°ch h√†ng': [f'C√¥ng ty {chr(65 + i%26)}{i}' for i in range(200)],
    'T·ªânh th√†nh': np.random.choice(['H√† N·ªôi', 'TP.HCM', 'ƒê√† N·∫µng', 'C·∫ßn Th∆°', 'H·∫£i Ph√≤ng', 'Qu·∫£ng Ninh', 'Hu·∫ø', 'Nha Trang'], 200),
    'Email': [f'contact{i}@company.com' for i in range(200)],
    'ƒêi·ªán tho·∫°i': [f'0{np.random.randint(3,9)}{np.random.randint(10000000,99999999)}' for i in range(200)],
    'T·ªïng chi ti√™u': np.random.randint(1000000, 100000000, 200),
    'S·ªë l·∫ßn mua': np.random.randint(1, 50, 200),
    'NƒÉm ƒëƒÉng k√Ω': np.random.randint(2020, 2024, 200),
    'Lo·∫°i kh√°ch': np.random.choice(['VIP', 'Th∆∞·ªùng', 'M·ªõi'], 200)
}
df_customers = pd.DataFrame(customers_data)

# ===== SHEET 4: S·∫¢N PH·∫®M =====
products_data = {
    'M√£ SP': [f'SP{i:04d}' for i in range(1, 101)],
    'T√™n s·∫£n ph·∫©m': [f'S·∫£n ph·∫©m {i}' for i in range(1, 101)],
    'Danh m·ª•c': np.random.choice(['Laptop', 'ƒêi·ªán tho·∫°i', 'Tablet', 'Ph·ª• ki·ªán', 'D·ªãch v·ª•'], 100),
    'Gi√° b√°n': np.random.randint(500000, 50000000, 100),
    'Gi√° v·ªën': np.random.randint(300000, 40000000, 100),
    'T·ªìn kho': np.random.randint(0, 1000, 100),
    'ƒê∆°n v·ªã': np.random.choice(['Chi·∫øc', 'B·ªô', 'H·ªôp', 'C√°i'], 100),
    'Nh√† cung c·∫•p': np.random.choice(['Samsung', 'Apple', 'Intel', 'Dell', 'HP'], 100),
    'Ng√†y c·∫≠p nh·∫≠t': pd.date_range('2024-01-01', periods=100, freq='D'),
    'T√¨nh tr·∫°ng': np.random.choice(['C√≤n h√†ng', 'H·∫øt h√†ng', 'S·∫Øp h·∫øt'], 100)
}
df_products = pd.DataFrame(products_data)

# ===== SHEET 5: DOANH S·ªê THEO TH√ÅNG =====
months = pd.date_range('2023-01-01', '2024-12-31', freq='MS')
revenue_data = {
    'Th√°ng': [m.strftime('%Y-%m') for m in months],
    'H√† N·ªôi': np.random.randint(50000000, 200000000, len(months)),
    'TP.HCM': np.random.randint(50000000, 200000000, len(months)),
    'ƒê√† N·∫µng': np.random.randint(20000000, 100000000, len(months)),
    'C·∫ßn Th∆°': np.random.randint(15000000, 80000000, len(months)),
    'H·∫£i Ph√≤ng': np.random.randint(15000000, 80000000, len(months))
}
df_revenue = pd.DataFrame(revenue_data)
df_revenue['T·ªïng c·ªông'] = df_revenue[['H√† N·ªôi', 'TP.HCM', 'ƒê√† N·∫µng', 'C·∫ßn Th∆°', 'H·∫£i Ph√≤ng']].sum(axis=1)

# ===== SHEET 6: TH·ªêNG K√ä NHANH =====
summary_data = {
    'Ch·ªâ s·ªë': [
        'T·ªïng doanh thu',
        'T·ªïng l·ª£i nhu·∫≠n',
        'S·ªë l∆∞·ª£ng kh√°ch h√†ng',
        'S·ªë l∆∞·ª£ng s·∫£n ph·∫©m',
        'S·ªë nh√¢n vi√™n',
        'Trung b√¨nh gi√° tr·ªã ƒë∆°n h√†ng',
        'T·ª∑ su·∫•t l·ª£i nhu·∫≠n'
    ],
    'Gi√° tr·ªã': [
        f"{df_sales['Doanh thu (VNƒê)'].sum():,.0f}",
        f"{(df_sales['Doanh thu (VNƒê)'].sum() * 0.25):,.0f}",
        len(df_customers),
        len(df_products),
        len(df_employees),
        f"{df_sales['Doanh thu (VNƒê)'].mean():,.0f}",
        "25%"
    ]
}
df_summary = pd.DataFrame(summary_data)

# ===== T·∫†O FILE EXCEL =====
with pd.ExcelWriter('sample_data.xlsx', engine='openpyxl') as writer:
    df_sales.to_excel(writer, sheet_name='B√°n h√†ng', index=False)
    df_employees.to_excel(writer, sheet_name='Nh√¢n vi√™n', index=False)
    df_customers.to_excel(writer, sheet_name='Kh√°ch h√†ng', index=False)
    df_products.to_excel(writer, sheet_name='S·∫£n ph·∫©m', index=False)
    df_revenue.to_excel(writer, sheet_name='Doanh s·ªë th√°ng', index=False)
    df_summary.to_excel(writer, sheet_name='Th·ªëng k√™', index=False)

print("‚úÖ T·∫°o file Excel th√†nh c√¥ng: sample_data.xlsx\n")
print("üìä N·ªôi dung file:")
print(f"  1Ô∏è‚É£  Sheet 'B√°n h√†ng': {len(df_sales)} d√≤ng")
print(f"      C·ªôt: {', '.join(df_sales.columns.tolist())}\n")

print(f"  2Ô∏è‚É£  Sheet 'Nh√¢n vi√™n': {len(df_employees)} d√≤ng")
print(f"      C·ªôt: {', '.join(df_employees.columns.tolist())}\n")

print(f"  3Ô∏è‚É£  Sheet 'Kh√°ch h√†ng': {len(df_customers)} d√≤ng")
print(f"      C·ªôt: {', '.join(df_customers.columns.tolist())}\n")

print(f"  4Ô∏è‚É£  Sheet 'S·∫£n ph·∫©m': {len(df_products)} d√≤ng")
print(f"      C·ªôt: {', '.join(df_products.columns.tolist())}\n")

print(f"  5Ô∏è‚É£  Sheet 'Doanh s·ªë th√°ng': {len(df_revenue)} d√≤ng")
print(f"      C·ªôt: {', '.join(df_revenue.columns.tolist())}\n")

print(f"  6Ô∏è‚É£  Sheet 'Th·ªëng k√™': {len(df_summary)} d√≤ng")
print(f"      C√≥≈Ç: {', '.join(df_summary.columns.tolist())}\n")

print("üöÄ B·∫°n c√≥ th·ªÉ upload file n√†y v√†o Streamlit Dashboard!")
